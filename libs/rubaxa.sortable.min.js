// Sortable @author	RubaXa   <trash@rubaxa.org> MIT
!function(b){"use strict";"function"==typeof define&&define.amd?define(b):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=b():window.Sortable=b()}(function(){"use strict";function O(a,b){if(!a||!a.nodeType||1!==a.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(a);this.el=a,this.options=b=fa({},b),a[y]=this;var c={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(a.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,setData:function(a,b){a.setData("Text",b.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0}};for(var d in c)!(d in b)&&(b[d]=c[d]);N(b);for(var e in this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this));this.nativeDraggable=!b.forceFallback&&F,T(a,"mousedown",this._onTapStart),T(a,"touchstart",this._onTapStart),T(a,"pointerdown",this._onTapStart),this.nativeDraggable&&(T(a,"dragover",this),T(a,"dragenter",this)),L.push(this._onDragOver),b.store&&this.sort(b.store.get(this))}function P(a,c){"clone"!==a.lastPullMode&&(c=!0),e&&e.state!==c&&(W(e,"display",c?"none":""),c||e.state&&(a.options.group.revertClone?(f.insertBefore(e,g),a._animate(b,e)):f.insertBefore(e,b)),e.state=c)}function Q(a,b,c){if(a){c=c||A;do if(">*"===b&&a.parentNode===c||da(a,b))return a;while(a=R(a))}return null}function R(a){var b=a.host;return b&&b.nodeType?b:a.parentNode}function S(a){a.dataTransfer&&(a.dataTransfer.dropEffect="move"),a.preventDefault()}function T(a,b,c){a.addEventListener(b,c,E)}function U(a,b,c){a.removeEventListener(b,c,E)}function V(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(w," ").replace(" "+b+" "," ");a.className=(d+(c?" "+b:"")).replace(w," ")}}function W(a,b,c){var d=a&&a.style;if(d){if(void 0===c)return A.defaultView&&A.defaultView.getComputedStyle?c=A.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];b in d||(b="-webkit-"+b),d[b]=c+("string"==typeof c?"":"px")}}function X(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;e<f;e++)c(d[e],e);return d}return[]}function Y(a,b,c,d,f,g,h){a=a||b[y];var i=A.createEvent("Event"),j=a.options,k="on"+c.charAt(0).toUpperCase()+c.substr(1);i.initEvent(c,!0,!0),i.to=b,i.from=f||b,i.item=d||b,i.clone=e,i.oldIndex=g,i.newIndex=h,b.dispatchEvent(i),j[k]&&j[k].call(a,i)}function Z(a,b,c,d,e,f,g){var h,k,i=a[y],j=i.options.onMove;return h=A.createEvent("Event"),h.initEvent("move",!0,!0),h.to=b,h.from=a,h.dragged=c,h.draggedRect=d,h.related=e||b,h.relatedRect=f||b.getBoundingClientRect(),a.dispatchEvent(h),j&&(k=j.call(i,h,g)),k}function $(a){a.draggable=!1}function _(){H=!1}function aa(a,b){var c=a.lastElementChild,d=c.getBoundingClientRect();return(b.clientY-(d.top+d.height)>5||b.clientX-(d.right+d.width)>5)&&c}function ba(a){for(var b=a.tagName+a.className+a.src+a.href+a.textContent,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}function ca(a,b){var c=0;if(!a||!a.parentNode)return-1;for(;a&&(a=a.previousElementSibling);)"TEMPLATE"===a.nodeName.toUpperCase()||">*"!==b&&!da(a,b)||c++;return c}function da(a,b){if(a){b=b.split(".");var c=b.shift().toUpperCase(),d=new RegExp("\\s("+b.join("|")+")(?=\\s)","g");return!(""!==c&&a.nodeName.toUpperCase()!=c||b.length&&((" "+a.className+" ").match(d)||[]).length!=b.length)}return!1}function ea(a,b){var c,d;return function(){void 0===c&&(c=arguments,d=this,setTimeout(function(){1===c.length?a.call(d,c[0]):a.apply(d,c),c=void 0},b))}}function fa(a,b){if(a&&b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function ga(a){return C?C(a).clone(!0)[0]:D&&D.dom?D.dom(a).cloneNode(!0):a.cloneNode(!0)}function ha(a){for(var b=a.getElementsByTagName("input"),c=b.length;c--;){var d=b[c];d.checked&&K.push(d)}}if("undefined"==typeof window||!window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,t,u,v,s={},w=/\s+/g,x=/left|right|inline/,y="Sortable"+(new Date).getTime(),z=window,A=z.document,B=z.parseInt,C=z.jQuery||z.Zepto,D=z.Polymer,E=!1,F=!!("draggable"in A.createElement("div")),G=function(a){return!navigator.userAgent.match(/Trident.*rv[ :]?11\./)&&(a=A.createElement("x"),a.style.cssText="pointer-events:auto","auto"===a.style.pointerEvents)}(),H=!1,I=Math.abs,J=Math.min,K=[],L=[],M=ea(function(a,b,c){if(c&&b.scroll){var e,f,p,q,r,t,d=c[y],g=b.scrollSensitivity,h=b.scrollSpeed,l=a.clientX,m=a.clientY,n=window.innerWidth,o=window.innerHeight;if(j!==c&&(i=b.scroll,j=c,k=b.scrollFn,i===!0)){i=c;do if(i.offsetWidth<i.scrollWidth||i.offsetHeight<i.scrollHeight)break;while(i=i.parentNode)}i&&(e=i,f=i.getBoundingClientRect(),p=(I(f.right-l)<=g)-(I(f.left-l)<=g),q=(I(f.bottom-m)<=g)-(I(f.top-m)<=g)),p||q||(p=(n-l<=g)-(l<=g),q=(o-m<=g)-(m<=g),(p||q)&&(e=z)),s.vx===p&&s.vy===q&&s.el===e||(s.el=e,s.vx=p,s.vy=q,clearInterval(s.pid),e&&(s.pid=setInterval(function(){return t=q?q*h:0,r=p?p*h:0,"function"==typeof k?k.call(d,r,t,a):void(e===z?z.scrollTo(z.pageXOffset+r,z.pageYOffset+t):(e.scrollTop+=t,e.scrollLeft+=r))},24)))}},30),N=function(a){function b(a,b){return void 0!==a&&a!==!0||(a=c.name),"function"==typeof a?a:function(c,d){var e=d.options.group.name;return b?a:a&&(a.join?a.indexOf(e)>-1:e==a)}}var c={},d=a.group;d&&"object"==typeof d||(d={name:d}),c.name=d.name,c.checkPull=b(d.pull,!0),c.checkPut=b(d.put),c.revertClone=d.revertClone,a.group=c};O.prototype={constructor:O,_onTapStart:function(a){var m,c=this,d=this.el,e=this.options,f=e.preventOnFilter,g=a.type,i=a.touches&&a.touches[0],j=(i||a).target,k=a.target.shadowRoot&&a.path[0]||j,l=e.filter;if(ha(d),!b&&!("mousedown"===g&&0!==a.button||e.disabled)&&(j=Q(j,e.draggable,d),j&&h!==j)){if(m=ca(j,e.draggable),"function"==typeof l){if(l.call(this,a,j,this))return Y(c,k,"filter",j,d,m),void(f&&a.preventDefault())}else if(l&&(l=l.split(",").some(function(a){if(a=Q(k,a.trim(),d))return Y(c,a,"filter",j,d,m),!0})))return void(f&&a.preventDefault());e.handle&&!Q(k,e.handle,d)||this._prepareDragStart(a,i,j,m)}},_prepareDragStart:function(a,d,e,i){var n,j=this,k=j.el,l=j.options,m=k.ownerDocument;e&&!b&&e.parentNode===k&&(t=a,f=k,b=e,c=b.parentNode,g=b.nextSibling,h=e,q=l.group,o=i,this._lastX=(d||a).clientX,this._lastY=(d||a).clientY,b.style["will-change"]="transform",n=function(){j._disableDelayedDrag(),b.draggable=j.nativeDraggable,V(b,l.chosenClass,!0),j._triggerDragStart(a,d),Y(j,f,"choose",b,f,o)},l.ignore.split(",").forEach(function(a){X(b,a.trim(),$)}),T(m,"mouseup",j._onDrop),T(m,"touchend",j._onDrop),T(m,"touchcancel",j._onDrop),T(m,"pointercancel",j._onDrop),T(m,"selectstart",j),l.delay?(T(m,"mouseup",j._disableDelayedDrag),T(m,"touchend",j._disableDelayedDrag),T(m,"touchcancel",j._disableDelayedDrag),T(m,"mousemove",j._disableDelayedDrag),T(m,"touchmove",j._disableDelayedDrag),T(m,"pointermove",j._disableDelayedDrag),j._dragStartTimer=setTimeout(n,l.delay)):n())},_disableDelayedDrag:function(){var a=this.el.ownerDocument;clearTimeout(this._dragStartTimer),U(a,"mouseup",this._disableDelayedDrag),U(a,"touchend",this._disableDelayedDrag),U(a,"touchcancel",this._disableDelayedDrag),U(a,"mousemove",this._disableDelayedDrag),U(a,"touchmove",this._disableDelayedDrag),U(a,"pointermove",this._disableDelayedDrag)},_triggerDragStart:function(a,c){c=c||("touch"==a.pointerType?a:null),c?(t={target:b,clientX:c.clientX,clientY:c.clientY},this._onDragStart(t,"touch")):this.nativeDraggable?(T(b,"dragend",this),T(f,"dragstart",this._onDragStart)):this._onDragStart(t,!0);try{A.selection?setTimeout(function(){A.selection.empty()}):window.getSelection().removeAllRanges()}catch(a){}},_dragStarted:function(){if(f&&b){var a=this.options;V(b,a.ghostClass,!0),V(b,a.dragClass,!1),O.active=this,Y(this,f,"start",b,f,o)}else this._nulling()},_emulateDragOver:function(){if(u){if(this._lastX===u.clientX&&this._lastY===u.clientY)return;this._lastX=u.clientX,this._lastY=u.clientY,G||W(d,"display","none");var a=A.elementFromPoint(u.clientX,u.clientY),b=a,c=L.length;if(b)do{if(b[y]){for(;c--;)L[c]({clientX:u.clientX,clientY:u.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);G||W(d,"display","")}},_onTouchMove:function(a){if(t){var b=this.options,c=b.fallbackTolerance,e=b.fallbackOffset,f=a.touches?a.touches[0]:a,g=f.clientX-t.clientX+e.x,h=f.clientY-t.clientY+e.y,i=a.touches?"translate3d("+g+"px,"+h+"px,0)":"translate("+g+"px,"+h+"px)";if(!O.active){if(c&&J(I(f.clientX-this._lastX),I(f.clientY-this._lastY))<c)return;this._dragStarted()}this._appendGhost(),v=!0,u=f,W(d,"webkitTransform",i),W(d,"mozTransform",i),W(d,"msTransform",i),W(d,"transform",i),a.preventDefault()}},_appendGhost:function(){if(!d){var g,a=b.getBoundingClientRect(),c=W(b),e=this.options;d=b.cloneNode(!0),V(d,e.ghostClass,!1),V(d,e.fallbackClass,!0),V(d,e.dragClass,!0),W(d,"top",a.top-B(c.marginTop,10)),W(d,"left",a.left-B(c.marginLeft,10)),W(d,"width",a.width),W(d,"height",a.height),W(d,"opacity","0.8"),W(d,"position","fixed"),W(d,"zIndex","100000"),W(d,"pointerEvents","none"),e.fallbackOnBody&&A.body.appendChild(d)||f.appendChild(d),g=d.getBoundingClientRect(),W(d,"width",2*a.width-g.width),W(d,"height",2*a.height-g.height)}},_onDragStart:function(a,c){var d=a.dataTransfer,g=this.options;this._offUpEvents(),q.checkPull(this,this,b,a)&&(e=ga(b),e.draggable=!1,e.style["will-change"]="",W(e,"display","none"),V(e,this.options.chosenClass,!1),f.insertBefore(e,b),Y(this,f,"clone",b)),V(b,g.dragClass,!0),c?("touch"===c?(T(A,"touchmove",this._onTouchMove),T(A,"touchend",this._onDrop),T(A,"touchcancel",this._onDrop),T(A,"pointermove",this._onTouchMove),T(A,"pointerup",this._onDrop)):(T(A,"mousemove",this._onTouchMove),T(A,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(d&&(d.effectAllowed="move",g.setData&&g.setData.call(this,d,b)),T(A,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(a){var i,j,k,o,h=this.el,p=this.options,s=p.group,t=O.active,u=q===s,w=!1,z=p.sort;if(void 0!==a.preventDefault&&(a.preventDefault(),!p.dragoverBubble&&a.stopPropagation()),!b.animated&&(v=!0,t&&!p.disabled&&(u?z||(o=!f.contains(b)):r===this||(t.lastPullMode=q.checkPull(this,t,b,a))&&s.checkPut(this,t,b,a))&&(void 0===a.rootEl||a.rootEl===this.el))){if(M(a,p,this.el),H)return;if(i=Q(a.target,p.draggable,h),j=b.getBoundingClientRect(),r!==this&&(r=this,w=!0),o)return P(t,!0),c=f,void(e||g?f.insertBefore(b,e||g):z||f.appendChild(b));if(0===h.children.length||h.children[0]===d||h===a.target&&(i=aa(h,a))){if(i){if(i.animated)return;k=i.getBoundingClientRect()}P(t,u),Z(f,h,b,j,i,k,a)!==!1&&(b.contains(h)||(h.appendChild(b),c=h),this._animate(j,b),i&&this._animate(k,i))}else if(i&&!i.animated&&i!==b&&void 0!==i.parentNode[y]){l!==i&&(l=i,m=W(i),n=W(i.parentNode)),k=i.getBoundingClientRect();var A=k.right-k.left,B=k.bottom-k.top,C=x.test(m.cssFloat+m.display)||"flex"==n.display&&0===n["flex-direction"].indexOf("row"),D=i.offsetWidth>b.offsetWidth,E=i.offsetHeight>b.offsetHeight,F=(C?(a.clientX-k.left)/A:(a.clientY-k.top)/B)>.5,G=i.nextElementSibling,I=Z(f,h,b,j,i,k,a),J=!1;if(I!==!1){if(H=!0,setTimeout(_,30),P(t,u),1===I||I===-1)J=1===I;else if(C){var K=b.offsetTop,L=i.offsetTop;J=K===L?i.previousElementSibling===b&&!D||F&&D:i.previousElementSibling===b||b.previousElementSibling===i?(a.clientY-k.top)/B>.5:L>K}else w||(J=G!==b&&!E||F&&E);b.contains(h)||(J&&!G?h.appendChild(b):i.parentNode.insertBefore(b,J?G:i)),c=b.parentNode,this._animate(j,b),this._animate(k,i)}}}},_animate:function(a,b){var c=this.options.animation;if(c){var d=b.getBoundingClientRect();1===a.nodeType&&(a=a.getBoundingClientRect()),W(b,"transition","none"),W(b,"transform","translate3d("+(a.left-d.left)+"px,"+(a.top-d.top)+"px,0)"),b.offsetWidth,W(b,"transition","all "+c+"ms"),W(b,"transform","translate3d(0,0,0)"),clearTimeout(b.animated),b.animated=setTimeout(function(){W(b,"transition",""),W(b,"transform",""),b.animated=!1},c)}},_offUpEvents:function(){var a=this.el.ownerDocument;U(A,"touchmove",this._onTouchMove),U(A,"pointermove",this._onTouchMove),U(a,"mouseup",this._onDrop),U(a,"touchend",this._onDrop),U(a,"pointerup",this._onDrop),U(a,"touchcancel",this._onDrop),U(a,"selectstart",this)},_onDrop:function(a){var h=this.el,i=this.options;clearInterval(this._loopId),clearInterval(s.pid),clearTimeout(this._dragStartTimer),U(A,"mousemove",this._onTouchMove),this.nativeDraggable&&(U(A,"drop",this),U(h,"dragstart",this._onDragStart)),this._offUpEvents(),a&&(v&&(a.preventDefault(),!i.dropBubble&&a.stopPropagation()),d&&d.parentNode.removeChild(d),b&&(this.nativeDraggable&&U(b,"dragend",this),$(b),b.style["will-change"]="",V(b,this.options.ghostClass,!1),V(b,this.options.chosenClass,!1),f!==c?(p=ca(b,i.draggable),p>=0&&(Y(null,c,"add",b,f,o,p),Y(this,f,"remove",b,f,o,p),Y(null,c,"sort",b,f,o,p),Y(this,f,"sort",b,f,o,p))):(e&&e.parentNode.removeChild(e),b.nextSibling!==g&&(p=ca(b,i.draggable),p>=0&&(Y(this,f,"update",b,f,o,p),Y(this,f,"sort",b,f,o,p)))),O.active&&(null!=p&&p!==-1||(p=o),Y(this,f,"end",b,f,o,p),this.save()))),this._nulling()},_nulling:function(){f=b=c=d=g=e=h=i=j=t=u=v=p=l=m=r=q=O.active=null,K.forEach(function(a){a.checked=!0}),K.length=0},handleEvent:function(a){switch(a.type){case"drop":case"dragend":this._onDrop(a);break;case"dragover":case"dragenter":b&&(this._onDragOver(a),S(a));break;case"selectstart":a.preventDefault()}},toArray:function(){for(var b,a=[],c=this.el.children,d=0,e=c.length,f=this.options;d<e;d++)b=c[d],Q(b,f.draggable,this.el)&&a.push(b.getAttribute(f.dataIdAttr)||ba(b));return a},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,d){var e=c.children[d];Q(e,this.options.draggable,c)&&(b[a]=e)},this),a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},save:function(){var a=this.options.store;a&&a.set(this)},closest:function(a,b){return Q(a,b||this.options.draggable,this.el)},option:function(a,b){var c=this.options;return void 0===b?c[a]:(c[a]=b,void("group"===a&&N(c)))},destroy:function(){var a=this.el;a[y]=null,U(a,"mousedown",this._onTapStart),U(a,"touchstart",this._onTapStart),U(a,"pointerdown",this._onTapStart),this.nativeDraggable&&(U(a,"dragover",this),U(a,"dragenter",this)),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),L.splice(L.indexOf(this._onDragOver),1),this._onDrop(),this.el=a=null}},T(A,"touchmove",function(a){O.active&&a.preventDefault()});try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){E={capture:!1,passive:!1}}}))}catch(a){}return O.utils={on:T,off:U,css:W,find:X,is:function(a,b){return!!Q(a,b,a)},extend:fa,throttle:ea,closest:Q,toggleClass:V,clone:ga,index:ca},O.create=function(a,b){return new O(a,b)},O.version="1.5.0",O});